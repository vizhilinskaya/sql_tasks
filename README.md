# SQL-Karpov-Solved-Exercises

Решенные мною задачи из курса ["Симулятор SQL"](https://lab.karpov.courses/)

### Задача 1
Выведите все записи из таблицы products, отсортировав их по наименованиям товаров в алфавитном порядке, т.е. по возрастанию.

```sql
SELECT *
  FROM   products
 ORDER BY name;
```

### Задача 2
Отсортируйте таблицу **courier_actions** сначала по колонке **courier_id** по возрастанию id курьера, потом по колонке **action** (снова по возрастанию), а затем по колонке **time**, но уже по убыванию — от самого последнего действия к самому первому. Не забудьте включить в результат колонку **order_id**.
Добавьте в запрос оператор **LIMIT** и выведите только **первые 1000** строк результирующей таблицы.
Поля в результирующей таблице: **courier_id**, **order_id**, **action, time**.

```sql
SELECT courier_id, order_id, action, time
  FROM   courier_actions
 ORDER BY courier_id, action, time DESC
 LIMIT 1000;
```

### Задача 3
Определите 5 самых дорогих товаров в таблице **products**, которые доставляет наш сервис. Выведите их наименования и цену.
Поля в результирующей таблице: **name**, **price**.

```sql
SELECT name, price
  FROM   products
 ORDER BY price DESC
 LIMIT 5;
```

### Задача 4
Как в прошлом задании определите 5 самых дорогих товаров в таблице **products**. Но теперь колонки **name** и **price** переименуйте соответственно в **product_name** и **product_price**.
Поля в результирующей таблице: **product_name**, **product_price**.

```sql
SELECT name AS product_name,
       price AS product_price
  FROM   products
 ORDER BY price DESC
 LIMIT 5;
```

### Задача 5
Определите товар с самым длинным названием в таблице **products**. Выведите его наименование, длину наименования в символах, а также цену этого товара. Колонку с длиной наименования в символах назовите **name_length**.
Поля в результирующей таблице: **name**, **name_length**, **price**.

```sql
SELECT name,
       length(name) AS name_length,
       price
  FROM   products
 ORDER BY name_length DESC
 LIMIT 1;
```

### Задача 5
Примените последовательно функции **UPPER** и **SPLIT_PART** к колонке name и преобразуйте наименования товаров в таблице **products** так, чтобы от названий осталось только первое слово, записанное в верхнем регистре. Колонку с новым названием, состоящим из первого слова, назовите **first_word**.
В результат включите исходные наименования товаров, новые наименования из первого слова, а также цену товаров. Результат отсортируйте по возрастанию исходного наименования товара в колонке **name**.
Поля в результирующей таблице: **name**, **first_word**, **price**.

```sql
SELECT name,
       UPPER(SPLIT_PART(name, ' ', 1)) AS first_word,
       price
  FROM   products
 ORDER BY name;
```
### Задача 6
Измените тип колонки **price** из таблицы **products** на **VARCHAR**. Выведите колонки с наименованием товаров, ценой в исходном формате и ценой в формате **VARCHAR**. Новую колонку с ценой в новом формате назовите **price_char**.
Результат отсортируйте по возрастанию наименования товара в колонке name. Количество выводимых записей не ограничивайте.
Поле в результирующей таблице: **name**, **price**, **price_char**.

```sql
SELECT name,
       price :: varchar AS price_char,
       price
  FROM   products
 ORDER BY name;
```

### Задача 7
Для первых 200 записей из таблицы orders выведите информацию в следующем виде (обратите внимание на пробелы):
Заказ № [*id заказа*] создан [*дата*]
Полученную колонку назовите **order_info**.

```sql
SELECT CONCAT('Заказ № ', order_id, ' создан ', DATE(creation_time)) AS order_info
  FROM  orders
 LIMIT 200;
```

### Задача 8
Выведите **id** всех курьеров и их годы рождения из таблицы **couriers**.
Год рождения необходимо получить из колонки **birth_date**. Новую колонку с годом назовите **birth_year**. 
Результат отсортируйте сначала по убыванию года рождения курьера (т.е. от самых младших к самым старшим), затем по возрастанию **id** курьера.
Поля в результирующей таблице: **courier_id**, **birth_year**.

```sql
SELECT courier_id,
       DATE_PART('year', birth_date) AS birth_year
  FROM   couriers
 ORDER BY birth_year DESC, courier_id;
```

### Задача 9
Как и в предыдущем задании, снова выведите **id** всех курьеров и их годы рождения, только теперь к извлеченному году примените функцию **COALESCE**. Укажите параметры функции так, чтобы вместо **NULL** значений в результат попадало текстовое значение **unknown**. Названия полей оставьте прежними.
Отсортируйте итоговую таблицу сначала по убыванию года рождения курьера, затем по возрастанию id курьера.
Поля в результирующей таблице: **courier_id**, **birth_year**.

```sql
SELECT courier_id,
       COALESCE(DATE_PART('year', birth_date)::varchar, 'unknown') AS birth_year
  FROM   couriers
 ORDER BY birth_year DESC, courier_id;
```

### Задача 10
Давайте представим, что по какой-то необъяснимой причине мы вдруг решили в одночасье повысить цену всех товаров в таблице **products** на **5%**.
Выведите **id** и наименования всех товаров, их старую и новую цену. Колонку со старой ценой назовите **old_price**, а колонку с новой — **new_price**.
Результат отсортируйте сначала по убыванию новой цены, затем по возрастанию **id** товара.
Поля в результирующей таблице: **product_id**, **name**, **old_price**, **new_price**.

```sql
SELECT product_id,
       name,
       price AS old_price,
       price * 1.05 AS new_price
  FROM   products
 ORDER BY new_price DESC, product_id;
```

### Задача 10
Вновь, как и в прошлом задании, повысьте цену всех товаров на **5%**, только теперь к колонке с новой ценой примените функцию **ROUND**. Выведите **id** и наименования товаров, их старую цену, а также новую цену с округлением. Новую цену округлите до одного знака после запятой, но тип данных не меняйте.
Результат отсортируйте сначала по убыванию новой цены, затем по возрастанию **id** товара.
Поля в результирующей таблице: **product_id, name, old_price, new_price**.

```sql
SELECT product_id,
       name,
       price AS old_price,
       round(price*1.05, 1) AS new_price
  FROM   products
 ORDER BY new_price DESC, product_id;
```






